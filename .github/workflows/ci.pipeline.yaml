name: CI

on: [pull_request, push]

jobs:
  ruff:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: pip install ruff && ruff check . shared/ train/ deploy/ autolabel/

  black:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: pip install black && black --check . shared/ train/ deploy/ autolabel/

  mypy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: pip install mypy && mypy shared/ train/ deploy/ autolabel/

  pytest:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: pip install -e shared/ train/ deploy/ autolabel/ && python -m pytest shared/ train/ deploy/ autolabel/tests/ -v

  architecture:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: python scripts/architect/check_architecture.py
